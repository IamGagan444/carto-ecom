import{h as R,i as O,r as i,k as C,c as T,j as e,L as I,f as n,s as x}from"./index-7f94716b.js";const _="/assets/my-ba718d04.jpeg",J=()=>{const s=R(),{cartSlice:c}=O(t=>t);i.useEffect(()=>{s(C())},[s]),console.log(c);const d=Math.round((c.cartTotalAmount+c.cartTotalQuantity*20)*100),m="INR",y="receipt#1",p=T();function j(){return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"h-full w-full scale-105",children:e.jsx("path",{fillRule:"evenodd",d:"M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12zm13.36-1.814a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z",clipRule:"evenodd"})})}const[w,l]=i.useState(!1),[o,b]=i.useState(""),f=JSON.parse(localStorage.getItem("cartItems")),v=async t=>{if(o==2){l(!0);try{const g=await(await fetch("https://backend-carto-api.onrender.com/order",{method:"post",body:JSON.stringify({amount:d,currency:m,receipt:y}),headers:{"Content-Type":"application/json"}})).json();var r={key:"rzp_test_xwiFtDdURfF6Cl",amount:d,currency:m,name:"Gagan-carto limited",description:"Test Transaction",image:_,order_id:g.id,handler:async function(a){const N={...a},S=await(await fetch("https://backend-carto-api.onrender.com/order/validate",{method:"POST",body:JSON.stringify(N),headers:{"Content-Type":"application/json"}})).json();console.log("jsonres",S),p("/payment_success"),localStorage.setItem("allOrders",JSON.stringify(f)),s(x())},prefill:{name:"",email:"gaganpalai537@gmail.com",contact:"7846961770"},notes:{address:"Kalajamuna,humma,ganjam"},theme:{color:"#3399cc"}},h=new window.Razorpay(r);h.on("payment.failed",function(a){l(!1),alert(a.error.code),alert(a.error.description),alert(a.error.source),alert(a.error.step),alert(a.error.reason),alert(a.error.metadata.order_id),alert(a.error.metadata.payment_id)}),h.open(),t.preventDefault(),console.log("Razorpay Response:",g)}catch(u){console.error("Fetch error:",u),l(!1)}}else o==1&&(p("/payment_success"),localStorage.setItem("allOrders",JSON.stringify(f)),s(x()))};return w?e.jsx("div",{className:"h-screen grid place-items-center bg-white bottom-0 top-0 right-0 left-0",children:e.jsx(I,{})}):e.jsx("section",{className:"gradient h-screen grid place-items-center",children:e.jsxs("form",{action:"",className:"bg-white px-2 py-10 c500:p-10 w-full cu500:w-[470px] mx-auto  ",children:[e.jsx("h2",{className:"text-3xl font-semibold text-center mb-10",children:"Confirm Order"}),e.jsx("div",{children:[1,2].map((t,r)=>e.jsxs("label",{htmlFor:`vertical-list-react${r}`,className:"flex flex-row-reverse w-full justify-between cursor-pointer items-center pl-3 hover:bg-red-100",children:[e.jsx(n.ListItemPrefix,{className:"mr-3",children:e.jsx(n.Radio,{name:"vertical-list",id:`vertical-list-react${r}`,ripple:!1,icon:e.jsx(j,{}),className:"border-gray-900/10 bg-teal-900/5 p-0 transition-all hover:before:opacity-0 flex justify-between",onChange:()=>b(t),checked:o===t})}),e.jsx(n.Typography,{color:"blue-gray",className:`text-slate-700 hover:text-black  duration-200 capitalize ${o===t?"text-red-500 font-medium":""}`,children:t===1?"Cash on delivery":t===2?"Online payment":""})]},r))}),e.jsx("br",{}),e.jsx(n.Button,{variant:"gradient",size:"lg",color:"teal",className:"w-full  ",onClick:v,children:"confirm"})]})})};export{J as default};
